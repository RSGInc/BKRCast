
R version 3.3.3 (2017-03-06) -- "Another Canoe"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ##This is a temporary main control file with lots of TODOs to move 
> ##this whole effort to a package with project specific config and run files
> 
> #Rprof()
> 
> #-----------------------
> #Load packages
> #-----------------------
> ##TODO consider local R installation, with predownloaded packages in that library
> library(foreign)
> library(reshape)
> library(XLConnect)
Loading required package: XLConnectJars
XLConnect 0.2-12 by Mirai Solutions GmbH [aut],
  Martin Studer [cre],
  The Apache Software Foundation [ctb, cph] (Apache POI, Apache Commons
    Codec),
  Stephen Colebourne [ctb, cph] (Joda-Time Java library),
  Graph Builder [ctb, cph] (Curvesapi Java library)
http://www.mirai-solutions.com ,
http://miraisolutions.wordpress.com
> library(descr)
> library(Hmisc)
Loading required package: lattice
Loading required package: survival
Loading required package: Formula
Loading required package: ggplot2

Attaching package: 'Hmisc'

The following objects are masked from 'package:base':

    format.pval, round.POSIXt, trunc.POSIXt, units

> library(data.table)

Attaching package: 'data.table'

The following object is masked from 'package:reshape':

    melt

> library(plyr)

Attaching package: 'plyr'

The following objects are masked from 'package:Hmisc':

    is.discrete, summarize

The following objects are masked from 'package:reshape':

    rename, round_any

> 
> setwd("D:/Sensitivity Test/BKRCast_V1-3_Test13/daysim_summaries/bkrcast_all")
> 
> #------------------------------------
> #Source functions and config settings
> #------------------------------------
> source("utilfunc.R")
> #TODO function in package to create template config file in a specified location
> source("daysim_output_config.R")
> 
> progressStart("run DaySim summaries",14)
> 
> #-----------------------
> #Load data
> #-----------------------
> 
> #Geographical correspondence
> countycorr <- fread(tazcountycorr)
> 
> #Load DaySim outputs into Rdata files
> progressNextStep("reading hh data")
> if(runWrkSchLocationChoice | runVehAvailability | runDayPattern | runTourDestination | runTourMode)
+ {
+   if(prepDaySim)
+     readSaveRdata(dshhfile,"dshhdata")
+   if(prepSurvey)
+     readSaveRdata(surveyhhfile,"survhhdata")
+ }
> 
> progressNextStep("reading person data")
> if(runWrkSchLocationChoice | runDayPattern | runTourDestination | runTourMode | runTourTOD | runTripMode | runTripTOD)
+ {
+   if(prepDaySim)
+     readSaveRdata(dsperfile,"dsperdata")
+   if(prepSurvey)
+     readSaveRdata(surveyperfile,"survperdata")
+ }
Read 9.3% of 3745413 rowsRead 22.7% of 3745413 rowsRead 36.8% of 3745413 rowsRead 50.2% of 3745413 rowsRead 64.3% of 3745413 rowsRead 79.3% of 3745413 rowsRead 93.4% of 3745413 rowsRead 3745413 rows and 24 (of 24) columns from 0.303 GB file in 00:00:09
> 
> progressNextStep("reading person day data")
> if(runDayPattern)
+ {
+   if(prepDaySim)
+     readSaveRdata(dspdayfile,"dspdaydata")
+   if(prepSurvey)
+     readSaveRdata(surveypdayfile,"survpdaydata")
+ }
Read 42.2% of 3745413 rowsRead 72.6% of 3745413 rowsRead 3745413 rows and 31 (of 31) columns from 0.296 GB file in 00:00:04
> 
> progressNextStep("reading person day tour data")
> if(runDayPattern | runTourDestination | runTourMode | runTourTOD | runTripMode)
+ {
+   if(prepDaySim)
+     readSaveRdata(dstourfile,"dstourdata")
+   if(prepSurvey)
+     readSaveRdata(surveytourfile,"survtourdata")
+ }
Read 3.7% of 6002784 rowsRead 9.7% of 6002784 rowsRead 15.7% of 6002784 rowsRead 21.8% of 6002784 rowsRead 27.8% of 6002784 rowsRead 34.2% of 6002784 rowsRead 40.5% of 6002784 rowsRead 46.8% of 6002784 rowsRead 52.5% of 6002784 rowsRead 58.6% of 6002784 rowsRead 64.6% of 6002784 rowsRead 71.5% of 6002784 rowsRead 78.3% of 6002784 rowsRead 84.5% of 6002784 rowsRead 90.5% of 6002784 rowsRead 96.6% of 6002784 rowsRead 6002784 rows and 33 (of 33) columns from 0.766 GB file in 00:00:18
> 
> progressNextStep("reading person day trip data")
> if(runDayPattern | runTripMode | runTripTOD)
+ {
+   if(prepDaySim)
+     readSaveRdata(dstripfile,"dstripdata")
+   if(prepSurvey)
+     readSaveRdata(surveytripfile,"survtripdata")
+ }
Read 0.0% of 16541516 rowsRead 1.9% of 16541516 rowsRead 3.8% of 16541516 rowsRead 5.7% of 16541516 rowsRead 7.7% of 16541516 rowsRead 9.6% of 16541516 rowsRead 11.6% of 16541516 rowsRead 13.6% of 16541516 rowsRead 15.5% of 16541516 rowsRead 17.5% of 16541516 rowsRead 19.3% of 16541516 rowsRead 21.2% of 16541516 rowsRead 23.0% of 16541516 rowsRead 24.9% of 16541516 rowsRead 26.8% of 16541516 rowsRead 28.7% of 16541516 rowsRead 30.6% of 16541516 rowsRead 32.5% of 16541516 rowsRead 34.5% of 16541516 rowsRead 36.5% of 16541516 rowsRead 38.4% of 16541516 rowsRead 40.3% of 16541516 rowsRead 42.3% of 16541516 rowsRead 44.2% of 16541516 rowsRead 46.1% of 16541516 rowsRead 48.0% of 16541516 rowsRead 50.0% of 16541516 rowsRead 51.9% of 16541516 rowsRead 53.9% of 16541516 rowsRead 55.8% of 16541516 rowsRead 57.7% of 16541516 rowsRead 59.5% of 16541516 rowsRead 61.5% of 16541516 rowsRead 63.4% of 16541516 rowsRead 65.4% of 16541516 rowsRead 67.5% of 16541516 rowsRead 69.6% of 16541516 rowsRead 71.6% of 16541516 rowsRead 73.6% of 16541516 rowsRead 75.6% of 16541516 rowsRead 77.7% of 16541516 rowsRead 79.7% of 16541516 rowsRead 81.6% of 16541516 rowsRead 83.5% of 16541516 rowsRead 85.5% of 16541516 rowsRead 87.5% of 16541516 rowsRead 89.4% of 16541516 rowsRead 91.3% of 16541516 rowsRead 93.2% of 16541516 rowsRead 95.2% of 16541516 rowsRead 97.0% of 16541516 rowsRead 99.0% of 16541516 rowsRead 16541516 rows and 28 (of 28) columns from 2.116 GB file in 00:00:56
> 
> #Optional tour weight adjustment
> if(tourAdj)
+ {
+   touradj <- fread(tourAdjFile)
+ }
> 
> #force gc()
> gc()
          used (Mb) gc trigger   (Mb)  max used   (Mb)
Ncells 1458266 77.9    2637877  140.9   1770749   94.6
Vcells 1922220 14.7  216438273 1651.3 267460627 2040.6
> 
> #-----------------------
> #Run tabulations
> #-----------------------
> ##TODO split between preparing tables in an R object and then putting them somewhere
> ##TODO e.g. in a spreadsheet, in a pdf report, etc.
> 
> #source("nonhwy.R")
> 
> progressNextStep("summarizing work location choice")
> if(runWrkSchLocationChoice)
+ {
+   source("wrkschlocation.R")
+ }
[1] "Work/School Location Summary...Started"
[1] "Work/School Location Summary...Finished"
> progressNextStep("summarizing vehicle ownership choice")
> if(runVehAvailability)
+ {
+   source("vehavailability.R")
+ }
[1] "Vehicle Availabililty Summary...Started"
[1] "Vehicle Availabililty Summary...Finished"
> progressNextStep("summarizing Day pattern")
> if(runDayPattern)
+ {
+   source("daypattern.R")
+ }
[1] "Day Pattern Summary...Started"
[1] "Day Pattern Summary...Finished"
> progressNextStep("summarizing Destination Choice")
> if(runTourDestination)
+ {
+   source("tourdestination.R")
+ }
[1] "Tour Destination Summary...Started"
[1] "Tour Destination Summary...Finished"
> progressNextStep("summarizing Trip Destination Choice")
> if(runTourDestination)
+ {
+   source("tripdestination.R")
+ }
[1] "Trip Destination Summary...Started"
[1] "Trip Destination Summary...Finished"
> progressNextStep("summarizing Tour Mode Choice") 
> if(runTourMode)
+ {
+   source("tourmode.R")
+ }
[1] "Tour Mode Summary...Started"
[1] "Tour Mode Summary...Finished"
> progressNextStep("summarizing Tour Time of Day Choice") 
> if(runTourTOD)
+ {
+   source("tourtod.R")
+ }
[1] "Tour Time of Day Summary...Started"
[1] "Tour Time of Day Summary...Finished"
> progressNextStep("summarizing Trip Mode Choice") 
> if(runTripMode)
+ {
+   source("tripmode.R")
+ }
[1] "Trip Mode Summary...Started"
[1] "Trip Mode Summary...Finished"
> progressNextStep("summarizing Trip Time of Day Choice")
> if(runTripTOD)
+ {
+   source("triptod.R")
+ }
[1] "Trip Time of Day Summary...Started"
[1] "survey"
[1] "times are in minutes"
[1] "daysim"
[1] "times are in minutes"
[1] "Trip Time of Day Summary...Finished"
> 
> progressEnd(outputsDir)
   steps                            stepnames stepruntimes cumruntimes
1      1                      reading hh data         7.83        7.83
2      2                  reading person data        24.21       32.04
3      3              reading person day data        18.82       50.86
4      4         reading person day tour data        60.44      111.30
5      5         reading person day trip data       153.69      264.99
6      6     summarizing work location choice        22.28      287.27
7      7 summarizing vehicle ownership choice         4.55      291.82
8      8              summarizing Day pattern       118.95      410.77
9      9       summarizing Destination Choice        17.03      427.80
10    10  summarizing Trip Destination Choice        28.64      456.44
11    11         summarizing Tour Mode Choice        15.99      472.43
12    12  summarizing Tour Time of Day Choice        26.18      498.61
13    13         summarizing Trip Mode Choice        33.13      531.74
14    14  summarizing Trip Time of Day Choice        52.53      584.27
> 
> # Rprof(NULL)
> # memprof <- summaryRprof()
> 
> proc.time()
   user  system elapsed 
 619.00  528.92  587.87 
